<!-- <import src="../_partials/topTip.wxml" /> -->
<!-- <textarea bindblur="bindTextAreaBlur" style='width: 99%; height:400px; border:2px solid red; opacity: 0.1'></textarea> -->
<!-- <rich-text nodes="{{nodes}}" id="node1" data-id="1" style="border: 1px solid blue;" catchtap='tap' bindlongtap='longtap' bindtouchmove='touchmove' bindtouchend='touchend'></rich-text> -->

<rich-text nodes="{{nodes2}}" id="node2" data-id="2"  style="border: 1px solid red;" bindtap='tap' bindlongtap='longtap' bindtouchmove='touchmove' bindtouchend='touchend'></rich-text>

<!-- <rich-text nodes="{{nodes3}}" id="node3" data-id="3" style="border: 1px solid blue;" bindtap='tap' bindlongtap='longtap' bindtouchmove='touchmove' bindtouchend='touchend'></rich-text> -->

<view class="block">
  <block wx:for="{{nodes}}" wx:key="{{o}}">
  
    <block wx:if="{{ item.length }}">
      
        <view class='node' wx:if="{{item[0].name == 'h1' || item[0].name == 'h2' || item[0].name == 'h3' || item[0].name == 'h4' || item[0].name == 'h5'}}">
          <view wx-if="{{node_acitve == index}}" bindtap="handBlockUp" data-index="{{index}}" class="icon icon-up"></view>
          <input id="textarea-{{index}}" class="{{item[0].attrs.class}}" data-index="{{index}}" placeholder='{{item[0].children[0].text}}' auto-focus auto-height bindfocus="inputFocus" bindblur="textareaBlur" bindinput="textareaInput"></input>
          <view wx-if="{{node_acitve == index}}" bindtap="handBlockDown" data-index="{{index}}" class="icon icon-down"></view>
        </view>


        <view class='node' wx:elif="{{item[0].name == 'img'}}">
            <view wx-if="{{node_acitve == index}}" bindtap="handBlockUp" data-index="{{index}}" class="icon icon-up"></view>
            <image src="http://mat1.gtimg.com/xian/dcls2017/icon-text.png" />
            <view wx-if="{{node_acitve == index}}" bindtap="handBlockDown" data-index="{{index}}" class="icon icon-down"></view>
        </view>


        <view class='node' wx:else>
          <view wx-if="{{node_acitve == index}}" bindtap="handBlockUp" data-index="{{index}}" class="icon icon-up"></view>
          <textarea id="textarea-{{index}}" class="{{item[0].attrs.class}}" data-index="{{index}}" placeholder='{{item[0].children[0].text}}' auto-focus auto-height bindfocus="inputFocus" bindblur="textareaBlur" bindinput="textareaInput" maxlength="-1"></textarea>
          <view wx-if="{{node_acitve == index}}" bindtap="handBlockDown" data-index="{{index}}" class="icon icon-down"></view>
        </view>

        
    </block>
    <block wx:else>
        <view>无法解析！</view>
    </block>
    
  </block>
</view>

<view class="icons">
  <view id='H2' catchtap='tapIcon'>标题</view>
  <view id='H3' catchtap='tapIcon' style='font-size: 13px;'>标题</view>
  <view id='H4' catchtap='tapIcon' style='font-size: 12px'>标题</view>
  <view id='P' catchtap='tapIcon' >文本</view>
  <view id='IMG' catchtap='tapIcon' >图片</view>
  <view id='BLOCKQUOTE' catchtap='tapIcon' >“引用”</view>
  <!-- <view id='STRONG' catchtap='tapIcon' style='font-weight: 600'>加粗</view> -->
  <view id='CODE' catchtap='tapIcon'>源码</view>
</view>



<view class="page" style='display:none;'>
    <view>showMsg: showTopTips, msg: topTipMsg</view>
    
    <view class="page__bd sbox">
        <form bindsubmit="formSubmit">
        <!-- <textarea class="editor" auto-focus placeholder="...首行自动存为标题" name="textarea"/> -->







        <!-- diy 模块 -->
        <view class="block">
            <block wx:for="{{blocks}}" wx:key="{{o}}">
            <view class="weui-cells weui-cells_form block__item">
                <view class="weui-cell">
                    <view class="weui-cell__bd">
                        <block wx:if="{{ item.type }}">
                            <view class="block__toolbox">
                                <view bindtap="handBlockUp" data-index="{{index}}" class="icon icon-up"></view>
                                <view bindtap="handBlockDown" data-index="{{index}}" class="icon icon-down"></view>
                                <view bindtap="handBlockClose" data-index="{{index}}" class="icon icon-close"></view>
                            </view>
                            <block wx:if="{{ item.type=='text' }}">
                                <textarea class="u-textarea" name="field[{{item.index}}]" bindinput="bingContentInput" data-index="{{index}}" value="{{ item.value }}" placeholder="请输入..."></textarea>
                            </block>
                            <block wx:if="{{ item.type=='image' }}">
                                <input type="text" name="field[{{item.index}}]" value="{{item.value}}" style="display: none;" readonly="readonly"/>
                                <image src="{{item.value}}" class="u-image"></image>
                            </block>
                        </block>
                        <block wx:else>
                            <view class="flex padding">
                                <view class="flex__item block__item-type" animation="{{item.fadeOutLeft}}">
                                    <view class="block__item-type-text" bindtap="bingTypeSelect" data-type='text' data-index="{{index}}"></view>
                                </view>
                                <view class="flex__item" animation="{{item.fadeOutRight}}">
                                    <view class="block__item-type-image" bindtap="bingTypeSelect" data-type='image' data-index="{{index}}"></view>
                                </view>
                            </view>
                        </block>
                    </view>
                </view>
                <view class="weui-cell block__sidebar padding"  bindtap="handPlus" >
                    <view class="weui-cell__bd">
                        <view class="icon icon-plus"data-order="{{index+1}}"></view>
                    </view>
                </view>
            </view>
            </block>
        </view>

        <view class="block__btns">
            <button formType="submit" class="btn btn-primary btn-blank" disabled="{{submitDisabled}}">提交</button>
        </view>
        </form>
    </view>
</view>